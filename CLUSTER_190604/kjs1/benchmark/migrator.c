//gcc migrator.c -o migrator -lm


#include <stdio.h>
#include <math.h>

const double full_write = 890.0;

double chart_data[6][89] = {
{804.3,805.4,806.5,807.6,808.7,809.8,810.9,812.0,813.1,814.2,815.3,816.4,817.5,818.6,819.7,820.8,821.9,823.0,824.1,825.2,826.3,827.4,828.5,829.6,830.7,831.8,832.9,834.0,835.1,836.2,837.3,838.4,839.4,840.5,841.6,842.7,843.8,844.9,846.0,847.1,848.2,849.3,850.4,851.5,852.6,853.7,854.8,855.9,857.0,858.1,859.2,860.3,861.4,862.5,863.6,864.7,865.8,866.9,868.0,869.1,870.2,871.3,872.4,873.5,874.6,875.6,876.7,877.8,878.9,880.0,881.1,882.2,883.3,884.4,885.5,886.6,887.7,888.8,889.9,891.0,892.1,893.2,894.3,895.4,896.5,897.6,898.7,899.8},
{720.2,722.3,724.4,726.4,728.5,730.5,732.6,734.7,736.7,738.8,740.9,742.9,745.0,747.1,749.1,751.2,753.3,755.3,757.4,759.5,761.5,763.6,765.7,767.7,769.8,771.9,773.9,776.0,778.1,780.1,782.2,784.3,786.3,788.4,790.4,792.5,794.6,796.6,798.7,800.8,802.8,804.9,807.0,809.0,811.1,813.2,815.2,817.3,819.4,821.4,823.5,825.6,827.6,829.7,831.8,833.8,835.9,838.0,840.0,842.1,844.2,846.2,848.3,850.4,852.4,854.5,856.5,858.6,860.7,862.7,864.8,866.9,868.9,871.0,873.1,875.1,877.2,879.3,881.3,883.4,885.5,887.5,889.6,891.7,893.7,895.8,897.9,899.9},
{693.4,695.6,697.7,699.8,702.0,704.1,706.2,708.4,710.5,712.6,714.8,716.9,719.1,721.2,723.3,725.5,727.6,729.7,731.9,734.0,736.1,738.3,740.4,742.5,744.7,746.8,748.9,751.1,753.2,755.3,757.5,759.6,761.7,763.9,766.0,768.1,770.3,772.4,774.6,776.7,778.8,781.0,783.1,785.2,787.4,789.5,791.6,793.8,795.9,798.0,800.2,802.3,804.4,806.6,808.7,810.8,813.0,815.1,817.2,819.4,821.5,823.6,825.8,827.9,830.1,832.2,834.3,836.5,838.6,840.7,842.9,845.0,847.1,849.3,851.4,853.5,855.7,857.8,859.9,862.1,864.2,866.3,868.5,870.6,872.7,874.9,877.0,879.1},
{695.7,697.7,699.6,701.6,703.5,705.5,707.4,709.4,711.3,713.3,715.2,717.2,719.1,721.1,723.0,725.0,726.9,728.9,730.8,732.8,734.7,736.7,738.6,740.6,742.5,744.5,746.4,748.4,750.3,752.3,754.2,756.2,758.1,760.1,762.1,764.0,766.0,767.9,769.9,771.8,773.8,775.7,777.7,779.6,781.6,783.5,785.5,787.4,789.4,791.3,793.3,795.2,797.2,799.1,801.1,803.0,805.0,806.9,808.9,810.8,812.8,814.7,816.7,818.6,820.6,822.5,824.5,826.4,828.4,830.3,832.3,834.2,836.2,838.1,840.1,842.0,844.0,846.0,847.9,849.9,851.8,853.8,855.7,857.7,859.6,861.6,863.5,865.5},
{685.3,687.3,689.3,691.2,693.2,695.2,697.2,699.2,701.2,703.1,705.1,707.1,709.1,711.1,713.1,715.0,717.0,719.0,721.0,723.0,725.0,726.9,728.9,730.9,732.9,734.9,736.9,738.9,740.8,742.8,744.8,746.8,748.8,750.8,752.7,754.7,756.7,758.7,760.7,762.7,764.6,766.6,768.6,770.6,772.6,774.6,776.5,778.5,780.5,782.5,784.5,786.5,788.4,790.4,792.4,794.4,796.4,798.4,800.4,802.3,804.3,806.3,808.3,810.3,812.3,814.2,816.2,818.2,820.2,822.2,824.2,826.1,828.1,830.1,832.1,834.1,836.1,838.0,840.0,842.0,844.0,846.0,848.0,850.0,851.9,853.9,855.9,857.9},
{689.8,691.5,693.2,695.0,696.7,698.4,700.2,701.9,703.6,705.4,707.1,708.8,710.6,712.3,714.0,715.8,717.5,719.2,721.0,722.7,724.4,726.2,727.9,729.6,731.4,733.1,734.8,736.6,738.3,740.0,741.8,743.5,745.2,746.9,748.7,750.4,752.1,753.9,755.6,757.3,759.1,760.8,762.5,764.3,766.0,767.7,769.5,771.2,772.9,774.7,776.4,778.1,779.9,781.6,783.3,785.1,786.8,788.5,790.3,792.0,793.7,795.5,797.2,798.9,800.7,802.4,804.1,805.8,807.6,809.3,811.0,812.8,814.5,816.2,818.0,819.7,821.4,823.2,824.9,826.6,828.4,830.1,831.8,833.6,835.3,837.0,838.8,840.5},
};
//chart_data[6] = {751.4,752.4,753.4,754.4,755.4,756.4,757.4,758.4,759.4,760.3,761.3,762.3,763.3,764.3,765.3,766.3,767.3,768.3,769.3,770.2,771.2,772.2,773.2,774.2,775.2,776.2,777.2,778.2,779.1,780.1,781.1,782.1,783.1,784.1,785.1,786.1,787.1,788.1,789.0,790.0,791.0,792.0,793.0,794.0,795.0,796.0,797.0,797.9,798.9,799.9,800.9,801.9,802.9,803.9,804.9,805.9,806.9,807.8,808.8,809.8,810.8,811.8,812.8,813.8,814.8,815.8,816.7,817.7,818.7,819.7,820.7,821.7,822.7,823.7,824.7,825.7,826.6,827.6,828.6,829.6,830.6,831.6,832.6,833.6,834.6,835.5,836.5,837.5};


int best_migrator(int queue_length /*1 ~ 80*/, double remain_space /*0.0 ~ 1.0*/) {

    double write_threshold = 0.9; /* 0.0 ~ 1.0 */

    if(remain_space > 0.9 /*temporal*/) {

        write_threshold = 0.7;
    }
    else if(remain_space > 0.5 /*temporal*/) {

        write_threshold = 0.8;
    }
    int i;
    for(i = 1; i < 6; i++) {

        //floor(log(queue_length+1))  --> 정수화
        int indexnum = floor(log(queue_length+i));

        int estimated_wt = chart_data[i-1][indexnum];
        //math the value with the y_adjust table
        if(write_threshold*full_write > estimated_wt) return i-1;

    }
    return 6;
    
}

int main() {

    int queue = 5;
    double space = 0.95;

    printf("num of migrator %d\n", best_migrator(queue, space));

    return 0;
}
